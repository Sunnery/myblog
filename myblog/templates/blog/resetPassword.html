<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>this's my life</title>
	<link rel="stylesheet" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="http://cdn.gbtags.com/font-awesome/4.1.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="http://cdn.gbtags.com/summernote/0.5.2/summernote.css">
	<link href="static/css/douban.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="static/css/upload-style.css" type="text/css" />
</head>
<body>
<div class="container">
	<div class="row clearfix">
		<div class="col-md-12 column">
			<nav class="navbar navbar-default" role="navigation">
				<div class="navbar-header">
					 <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"> <span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button> <a class="navbar-brand" href="#">SUNNERY</a>
				</div>
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="nav navbar-nav">
						<li>
							 <a href="/index">主页</a>
						</li>
						<li>
							 <a href="/blogList">文章</a>
						</li>
						<li class="dropdown">
							 <a href="#" class="dropdown-toggle" data-toggle="dropdown">更多<strong class="caret"></strong></a>
							<ul class="dropdown-menu" style="font-size: 1px; min-width: 80px;width: 12px;">
								<li>
									 <a href="/unknow">无主之地</a>
								</li>
							</ul>
						</li>
					</ul>
					<form class="navbar-form navbar-left" role="search">
						<div class="form-group">
							<input type="text" class="form-control" />
						</div>
						<button type="submit" class="btn btn-default" style="font-size: 1px;">全局搜索</button>
					</form>
					<ul class="nav navbar-nav navbar-right">
						<li>
							{% if user.is_authenticated %}
								<li class="dropdown">
								 <a href="#" class="dropdown-toggle" data-toggle="dropdown">{{ user.username }}的养猪场<strong class="caret"></strong></a>
								<ul class="dropdown-menu" style="font-size: 1px;min-width: 117px;width: 12px;left: 1px;">
									<li>
										 <a href="/mySpace">我的猪圈</a>
									</li>
									<li>
										 <a href="/blogEdit">发布养猪经验</a>
									</li>
									<li>
										 <a href="/manage">猪圈管理</a>
									</li>
									<li>
										 <a href="/loginOut">退出</a>
									</li>
								</ul>
							</li>
							{% else %}
								<li>
									 <a href="/login">登陆</a>
								</li>
								<li>
									 <a href="/register">注册</a>
								</li>
							{% endif %}
						</li>

					</ul>
				</div>
			</nav>
			<div class="container">
				<div class="row clearfix">
					<div class="col-md-12 column">
						<h1 style="margin-top: 0px; margin-bottom: 0px; padding: 0px 0px 30px; font-size: 25px; font-weight: bold; color: rgb(73, 73, 73); word-wrap: break-word; font-family: arial, helvetica, sans-serif;">密码重置</h1>
						<div class="row clearfix">
							<div class="col-md-8 column">
								<form class="form-horizontal" role="form" id="fo" action="index"  enctype="multipart/form-data">{% csrf_token %}
									<table>{{form.as_table}}

										<span style="display: none; color:red;margin-left: 130px;" id="nickNameWarning"></span>
									<div class="form-group">
										 <label for="inputPassword3" class="col-sm-2 control-label">名号</label>
										<div class="col-sm-10">
											<input type="text" class="form-control" id="nickName" name="nickName" style="width: 250px;"/>
										</div>
									</div>
									<div class="form-group">
										 <label class="col-sm-2 control-label">原密码</label>
										<div class="col-sm-10">
											<input type="password" class="form-control" id="inputPassword3" name="inputPassword3" style="width: 250px;"/>
										</div>
									</div>
									<div class="form-group">
										 <label class="col-sm-2 control-label">新密码</label>
										<div class="col-sm-10">
											<input type="password" class="form-control" id="newpwd" name="newpwd" style="width: 250px;"/>
										</div>
									</div>
									<div class="form-group">
										 <label class="col-sm-2 control-label" style="font-weight: 10">新密码确认</label>
										<div class="col-sm-10">
											<input type="password" class="form-control" id="newpwdconfirm" name="newpwdconfirm" style="width: 250px;"/>
										</div>
									</div>
									<div class="form-group">
										<div class="col-sm-offset-2 col-sm-10" style="padding-left: 65px;">
											 <button id="modify"  type="button" class="btn btn-default">保存修改</button>
										</div>
									</div>
									</table>
								</form>
							</div>
							<div class="col-md-4 column" style="padding-top: 102px;">
								&gt;&nbsp;还没有有养猪资质? <a rel="nofollow" href="/register">立即注册</a>
							</div>
						</div>
					</div>
				</div>
			</div>
            <div id="footer">
                <span id="icp" class="fleft gray-link">
                    © 2016－2017 woyaoyangzhu.cc, all rights reserved
                </span>
						<span class="fright">
					   <a href="/about">关于我要养猪</a>
					· <a href="/contactus">联系我们</a>
					· <a href="/disclaimer">免责声明</a>
					· <a href="/help">帮助中心</a>
					· <a href="#">移动应用</a>
					· <a href="/partner">养猪广告</a>
                </span>
            </div>
		</div>
	</div>
</div>

</body>

<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="http://cdn.gbtags.com/summernote/0.5.2/summernote.min.js"></script>
<script type="text/javascript" src="static/js/cropbox.js"></script>
<script type="text/javascript">
    $.ajaxSetup({
        async : false
    });

	function check(){
		var result = 0;
		var inputPassword3 = $("#inputPassword3").val();
		var nickName = $("#nickName").val();
		$.get("/loginCheck",{'nickName':nickName,'inputPassword3':inputPassword3}, function(ret){
			result = ret.result;
		})
		return result;
	}

	function confirm(){
		var result = 0;
		var newpwd = $("#newpwd").val();
		var inputPassword3 = $("#inputPassword3").val();
		var nickName = $("#nickName").val();
		$.get("/resetpwdConfirm",{'nickName':nickName,'inputPassword3':inputPassword3,'newpwd':newpwd}, function(ret){
			result = ret.result;
		})
		return result;
	}

	$('#modify').on('click', function(){
		if($("#newpwdconfirm").val() != $("#newpwd").val()){
			$("#nickNameWarning").html("两次密码输入不一致，请重新输入！");
			$("#nickNameWarning").css('display','block');
			return;
		}
		var result = check();
		if(result == 0){
			$("#nickNameWarning").html("名号或者密码错误，请重新输入！");
			$("#nickNameWarning").css('display','block');
		}else{
			if(confirm()==0){
			alert('您的密码已重置！');
			$("#fo").submit();
			}else{
				$("#nickNameWarning").html("密码修改失败！");
				$("#nickNameWarning").css('display','block');
			}
		}
	});
</script>
</html>